<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MCP — Modelo de Protocolo de Contexto · Resumen y Guía</title>
  <style>
    :root{
      --bg:#0b0e14; --panel:#11161f; --card:#141a24; --text:#e6edf3; --muted:#a7b3c2; --brand:#6ee7ff; --accent:#a78bfa; --ok:#34d399; --warn:#f59e0b; --bad:#f87171; --border:#1f2937;
    }
    [data-theme="light"]{
      --bg:#f7f9fc; --panel:#ffffff; --card:#ffffff; --text:#0b1220; --muted:#4b5563; --brand:#0ea5e9; --accent:#7c3aed; --ok:#059669; --warn:#b45309; --bad:#b91c1c; --border:#e5e7eb;
    }
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--text);font:16px/1.55 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji"}
    .app{display:grid;grid-template-columns:280px 1fr;min-height:100vh}
    .sidebar{background:var(--panel);border-right:1px solid var(--border);position:sticky;top:0;height:100vh;overflow:auto}
    .brand{display:flex;align-items:center;gap:.6rem;padding:1rem 1.2rem;border-bottom:1px solid var(--border)}
    .brand .dot{width:10px;height:10px;border-radius:50%;background:linear-gradient(135deg,var(--brand),var(--accent))}
    .brand h1{font-size:1rem;margin:0;font-weight:700}
    .toc{list-style:none;margin:0;padding:.5rem 0}
    .toc a{display:block;padding:.55rem 1.2rem;color:var(--muted);text-decoration:none;border-left:3px solid transparent}
    .toc a:hover{color:var(--text);background:color-mix(in oklab,var(--brand) 10%,transparent)}
    .toc a.active{color:var(--text);border-color:var(--brand);background:color-mix(in oklab,var(--brand) 15%,transparent)}

    .content{padding:0;}
    .topbar{position:sticky;top:0;z-index:5;background:var(--panel);border-bottom:1px solid var(--border);display:flex;gap:.75rem;align-items:center;padding:.75rem 1rem}
    .topbar h2{margin:0;font-size:1rem;font-weight:700}
    .spacer{flex:1}
    .search{position:relative}
    .search input{background:var(--card);border:1px solid var(--border);color:var(--text);padding:.6rem 2.2rem .6rem .8rem;border-radius:.6rem;min-width:280px}
    .search .icon{position:absolute;right:.65rem;top:.62rem;opacity:.6}
    .toggle{cursor:pointer;border:1px solid var(--border);padding:.5rem .75rem;border-radius:.6rem;background:var(--card);color:var(--muted)}

    main{max-width:1100px;margin:0 auto;padding:1.25rem}
    section{background:var(--card);border:1px solid var(--border);border-radius:1rem;padding:1.25rem;margin:1rem 0;box-shadow:0 1px 0 rgba(0,0,0,.06)}
    section h3{margin-top:0}
    .kpi{display:grid;grid-template-columns:repeat(3,1fr);gap:.75rem}
    .kpi .card{background:var(--panel);border:1px solid var(--border);border-radius:.8rem;padding:.9rem}
    .badge{display:inline-block;padding:.15rem .5rem;border-radius:.4rem;font-size:.75rem;color:#0b1220;background:var(--brand)}
    .list{margin:.4rem 0;padding-left:1.2rem}
    .callout{border-left:4px solid var(--brand);padding:.75rem 1rem;background:color-mix(in oklab,var(--brand) 8%,transparent);border-radius:.4rem}

    pre{position:relative;background:#0b1220;border:1px solid #111827;color:#e6edf3;padding:1rem;border-radius:.6rem;overflow:auto}
    code{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;font-size:.9rem}
    .copy{position:absolute;top:.6rem;right:.6rem;font-size:.8rem;border:1px solid #1f2937;background:#111827;color:#e6edf3;border-radius:.4rem;padding:.3rem .5rem;cursor:pointer}
    .grid-2{display:grid;grid-template-columns:1fr 1fr;gap:.75rem}
    @media(max-width:960px){.app{grid-template-columns:1fr}.sidebar{position:fixed;left:-100%;width:260px;transition:left .25s ease}.sidebar.open{left:0}.topbar{position:sticky}.toggleMenu{display:inline-block}.toc a{padding:.5rem .9rem}}
    @media(min-width:961px){.toggleMenu{display:none}}
    .checklist li{margin:.35rem 0}
    .tag{display:inline-flex;align-items:center;gap:.4rem;border:1px dashed var(--border);padding:.25rem .5rem;border-radius:.4rem;color:var(--muted)}
  </style>
</head>
<body>
  <div class="app" id="app" data-theme="dark">
    <aside class="sidebar" id="sidebar">
      <div class="brand">
        <div class="dot"></div>
        <h1>MCP · Guía Rápida</h1>
      </div>
      <nav>
        <ul class="toc" id="toc">
          <li><a href="#intro">1. Introducción</a></li>
          <li><a href="#problema">2. El problema antes de MCP</a></li>
          <li><a href="#que-es-mcp">3. ¿Qué es MCP?</a></li>
          <li><a href="#arquitectura">4. Arquitectura</a></li>
          <li><a href="#despliegue">5. Despliegue (local/remoto)</a></li>
          <li><a href="#ejemplos">6. Ejemplos</a></li>
          <li><a href="#beneficios">7. Beneficios</a></li>
          <li><a href="#limitaciones">8. Limitaciones</a></li>
          <li><a href="#azure">9. Integración con Azure AI (Agentes)</a></li>
          <li><a href="#pasos">10. Paso a paso</a></li>
          <li><a href="#flujo">11. Flujo de trabajo</a></li>
          <li><a href="#practicas">12. Buenas prácticas</a></li>
          <li><a href="#glosario">13. Glosario</a></li>
        </ul>
      </nav>
    </aside>

    <div class="content">
      <div class="topbar">
        <button class="toggleMenu toggle" id="openSidebar">☰ Índice</button>
        <h2>MCP — Modelo de Protocolo de Contexto</h2>
        <span class="spacer"></span>
        <div class="search">
          <input id="search" placeholder="Buscar en la página (títulos y texto)…"/>
          <span class="icon">🔎</span>
        </div>
        <button class="toggle" id="theme">Modo claro/oscuro</button>
      </div>

      <main id="main">
        <section id="intro">
          <h3>1. Introducción</h3>
          <p><strong>MCP (Model Context Protocol)</strong> estandariza cómo las aplicaciones de IA (LLMs y agentes) se conectan a herramientas y APIs a través de <em>servidores MCP</em>. Piensa en MCP como un <span class="badge">“USB‑C para IA”</span>: conectas el servidor adecuado y listo.</p>
          <div class="kpi">
            <div class="card"><strong>Objetivo</strong><br/>Evitar que tu app “se rompa” cuando cambian las APIs.</div>
            <div class="card"><strong>Enfoque</strong><br/>Arquitectura cliente‑servidor: <em>host MCP</em> ⇄ <em>servidor MCP</em>.</div>
            <div class="card"><strong>Uso</strong><br/>Plug‑and‑play (local con Docker o remoto).</div>
          </div>
        </section>

        <section id="problema">
          <h3>2. El problema antes de MCP</h3>
          <ul class="list">
            <li>Debías definir manualmente <em>function calling</em> (nombre, descripción, parámetros) y el consumo de la API.</li>
            <li>Si el proveedor cambiaba <code>endpoints</code>, payloads o respuestas, tu agente fallaba.</li>
            <li>No controlas la API → no recibes avisos de cambios → deuda de mantenimiento.</li>
          </ul>
          <div class="grid-2">
            <div>
              <h4>Ejemplo sin MCP</h4>
              <pre><button class="copy" data-copy="#code1">Copiar</button><code id="code1">// Pseudocódigo: LLM + función meteorológica
function getWeather(location: string): Weather {
  const geo = GET("/geocode?q="+encode(location))
  const wx  = GET("/weather?lat="+geo.lat+"&lon="+geo.lon)
  return parseWeather(wx) // si cambia el formato → 💥
}
</code></pre>
            </div>
            <div>
              <h4>Riesgo</h4>
              <div class="callout">
                Cambios nocturnos del proveedor (URL, query, cuerpo, respuesta) <strong>rompen</strong> tu agente. 
                Terminas parcheando código en vez de crear valor.
              </div>
            </div>
          </div>
        </section>

        <section id="que-es-mcp">
          <h3>3. ¿Qué es MCP?</h3>
          <p><strong>MCP</strong> define un protocolo para que los <em>hosts MCP</em> (apps/LLMs) conversen con <em>servidores MCP</em> (wrappers mantenidos por el dueño o la comunidad de la API). El servidor encapsula la lógica de llamadas y los esquemas, aislando a tu app de cambios.</p>
          <ul class="list">
            <li><strong>Servidor MCP</strong>: empaqueta endpoints, autenticación y parsing.</li>
            <li><strong>Host MCP</strong>: tu agente/LLM que consume el servidor como herramienta.</li>
            <li><strong>Plug‑and‑play</strong>: reemplaza código ad‑hoc por integración estándar.</li>
          </ul>
        </section>

        <section id="arquitectura">
          <h3>4. Arquitectura (alto nivel)</h3>
          <pre><code>┌──────────────┐        Protocolo MCP        ┌───────────────────┐
│  Host MCP    │ ─────────────────────────▶  │  Servidor MCP     │
│ (LLM/Agente) │ ◀─────────────────────────  │ (API wrapper)     │
└──────────────┘                             └───────────────────┘
       │                                                 │
       │ Peticiones del usuario                          │ Llama APIs reales
       ▼                                                 ▼
  Orquesta herramientas                          Endpoints / Auth / Parse
</code></pre>
        </section>

        <section id="despliegue">
          <h3>5. Despliegue (local o remoto)</h3>
          <div class="grid-2">
            <div>
              <h4>Local (Docker)</h4>
              <ul class="list">
                <li>Máximo control de <span class="tag">privacidad</span> y <span class="tag">compliance</span>.</li>
                <li>Útil para servidores MCP de <em>sistema de archivos</em> o datos sensibles.</li>
              </ul>
              <pre><button class="copy" data-copy="#code2">Copiar</button><code id="code2"># Ejemplo (placeholder): ejecuta un servidor MCP en local
# Reemplaza &lt;imagen-servidor-mcp&gt; y variables según el servidor real

docker run --rm -p 8080:8080 \
  -e API_KEY=&quot;...&quot; \
  &lt;imagen-servidor-mcp&gt;:latest
</code></pre>
            </div>
            <div>
              <h4>Remoto (hosted)</h4>
              <ul class="list">
                <li>Operado por el proveedor o comunidad.</li>
                <li>Menos fricción operativa. Conecta por URL y credenciales.</li>
              </ul>
              <pre><button class="copy" data-copy="#code3">Copiar</button><code id="code3"># Conexión desde tu agente (pseudocódigo)
const mcpServer = {
  url: "https://mcp.mi-proveedor.com",
  auth: { type: "bearer", token: process.env.TOKEN }
}
agent.registerTool("weather-mcp", mcpServer)
</code></pre>
            </div>
          </div>
        </section>

        <section id="ejemplos">
          <h3>6. Ejemplos de servidores MCP</h3>
          <ul class="list">
            <li><strong>Gmail</strong>: lectura/envío seguro mediante wrapper oficial/comunitario.</li>
            <li><strong>GitHub</strong>: issues, PRs, repos; ideal para agentes dev.</li>
            <li><strong>Clima</strong>: wrapper sobre una API meteorológica.</li>
            <li><strong>Slack</strong>: mensajes y canales desde el agente.</li>
            <li><strong>Sistema de archivos local</strong>: renombrar/mover/leer sin salir del equipo.</li>
            <li><strong>Bases de datos</strong>: PostgreSQL / MongoDB vía operaciones controladas.</li>
          </ul>
          <div class="callout">Los nombres/imagenes concretas dependen del proveedor. Consulta su documentación para el <em>endpoint</em>, credenciales y permisos mínimos.</div>
        </section>

        <section id="beneficios">
          <h3>7. Beneficios</h3>
          <ul class="list">
            <li>Menos código ad‑hoc y <strong>menos roturas</strong> por cambios en APIs.</li>
            <li><strong>Estandarización</strong> de herramientas para LLMs/agentes.</li>
            <li><strong>Seguridad</strong>: ejecución local cuando lo necesitas.</li>
            <li><strong>Velocidad</strong>: integra “enchufar y usar”.</li>
          </ul>
        </section>

        <section id="limitaciones">
          <h3>8. Limitaciones</h3>
          <ul class="list">
            <li>Crear y mantener <em>servidores MCP</em> aún puede ser complejo.</li>
            <li>Dependes de que el proveedor publique/actualice su servidor.</li>
            <li>Catálogo en evolución: no todo servicio tiene MCP listo.</li>
          </ul>
        </section>

        <section id="azure">
          <h3>9. Integración con Azure AI Foundry / Servicio de Agentes</h3>
          <p>La idea es registrar el servidor MCP como una <strong>herramienta</strong> que el agente puede invocar. A alto nivel:</p>
          <ol class="list">
            <li>Disponibiliza el servidor MCP (URL pública o puerto local con túnel si aplica).</li>
            <li>Configura <em>auth</em> mínima necesaria (tokens/secretos gestionados en Key Vault o variables).</li>
            <li>Declara la herramienta en tu agente (nombre, descripción, capacidades expuestas por el servidor MCP).</li>
            <li>Permite al LLM decidir cuándo invocarla (via <em>tool use</em> / function calling).</li>
          </ol>
          <div class="grid-2">
            <div>
              <h4>Pseudocódigo (TypeScript)</h4>
              <pre><button class="copy" data-copy="#code4">Copiar</button><code id="code4">// Registrar servidor MCP como herramienta del agente
agent.addTool({
  name: "github-mcp",
  description: "Operaciones GitHub via MCP",
  endpoint: process.env.GITHUB_MCP_URL,
  auth: { type: "bearer", token: process.env.GH_TOKEN }
})

const reply = await agent.chat("Crea un issue si no existe uno similar")
</code></pre>
            </div>
            <div>
              <h4>Pseudocódigo (Python)</h4>
              <pre><button class="copy" data-copy="#code5">Copiar</button><code id="code5">agent.add_tool({
  "name": "fs-mcp",
  "description": "Sistema de archivos local (MCP)",
  "endpoint": os.environ["FS_MCP_URL"],
  "auth": {"type": "none"}
})
resp = agent.run("Renombra 'a.txt' a 'b.txt' en Descargas")
</code></pre>
            </div>
          </div>
        </section>

        <section id="pasos">
          <h3>10. Paso a paso recomendado</h3>
          <ol class="list">
            <li><strong>Elegir servidor MCP</strong>: oficial o comunitario que cubra tu caso de uso.</li>
            <li><strong>Desplegar</strong>: local (Docker) o remoto (SaaS/self‑hosted).</li>
            <li><strong>Configurar Auth</strong>: tokens con <em>least privilege</em> (Key Vault/Secrets).</li>
            <li><strong>Registrar en el agente</strong>: nombre, descripción y endpoint del servidor MCP.</li>
            <li><strong>Probar</strong>: prompts de verificación y casos límite.</li>
            <li><strong>Monitorear</strong>: logs, cuotas, errores, tiempos de respuesta.</li>
          </ol>
          <ul class="checklist list">
            <li>☑️ Principio de mínimo privilegio aplicado</li>
            <li>☑️ Trazabilidad de llamadas (correlación en logs)</li>
            <li>☑️ Límites de cuota configurados</li>
            <li>☑️ Retentiva/log rotation y alertas</li>
          </ul>
        </section>

        <section id="flujo">
          <h3>11. Flujo de trabajo (resumen)</h3>
          <pre><code>Usuario → (prompt) → Agente/LLM → Decide usar herramienta → Servidor MCP → API real
                                      ↑                                   ↓
                                   Razonamiento                     Respuesta estructurada
</code></pre>
        </section>

        <section id="practicas">
          <h3>12. Buenas prácticas</h3>
          <ul class="list">
            <li><strong>Versiona</strong> endpoints/contratos y documenta breaking changes.</li>
            <li>Autenticación segura (rotación de tokens; evita <em>hard‑code</em>).</li>
            <li>Time‑outs y reintentos con <em>backoff</em>.</li>
            <li>Validación estricta de entradas/salidas del servidor MCP.</li>
            <li>Permisos mínimos y <em>scopes</em> reducidos.</li>
          </ul>
        </section>

        <section id="glosario">
          <h3>13. Glosario</h3>
          <ul class="list">
            <li><strong>Host MCP</strong>: App/LLM que consume servidores MCP como herramientas.</li>
            <li><strong>Servidor MCP</strong>: Wrapper que estandariza llamadas a una API/servicio.</li>
            <li><strong>Tool use</strong>: Capacidad del LLM para invocar herramientas.</li>
            <li><strong>Self‑hosted</strong>: Servidor desplegado por ti (on‑prem o cloud).</li>
          </ul>
        </section>

        <section>
          <h3>Notas finales</h3>
          <p>Esta guía resume la introducción a MCP y cómo integrarlo con agentes (incluyendo Azure AI). Sustituye los placeholders por la información del servidor MCP que utilices (imagen, URL, variables y permisos exactos).</p>
        </section>
      </main>
    </div>
  </div>

  <script>
    // Tema claro/oscuro
    const app = document.getElementById('app');
    document.getElementById('theme').addEventListener('click',()=>{
      app.dataset.theme = app.dataset.theme === 'light' ? 'dark' : 'light';
      localStorage.setItem('mcp-theme', app.dataset.theme);
    });
    const savedTheme = localStorage.getItem('mcp-theme');
    if(savedTheme){ app.dataset.theme = savedTheme; }

    // Sidebar móvil
    const sidebar = document.getElementById('sidebar');
    document.getElementById('openSidebar').addEventListener('click',()=>{
      sidebar.classList.toggle('open');
    })

    // Copiar código
    document.querySelectorAll('.copy').forEach(btn=>{
      btn.addEventListener('click',()=>{
        const sel = document.querySelector(btn.dataset.copy);
        if(!sel) return;
        const text = sel.innerText;
        navigator.clipboard.writeText(text).then(()=>{
          btn.textContent = 'Copiado';
          setTimeout(()=>btn.textContent='Copiar',1200);
        });
      });
    });

    // Scrollspy de la TOC
    const links = Array.from(document.querySelectorAll('#toc a'));
    const sections = links.map(a=>document.querySelector(a.getAttribute('href'))).filter(Boolean);
    const onScroll = () => {
      let idx = sections.findIndex(sec => sec.getBoundingClientRect().top > 120);
      if(idx === -1) idx = sections.length - 1; else idx = Math.max(0, idx - 1);
      links.forEach(l=>l.classList.remove('active'));
      if(links[idx]) links[idx].classList.add('active');
    };
    document.addEventListener('scroll', onScroll, {passive:true});
    onScroll();

    // Búsqueda sencilla en títulos y texto
    const search = document.getElementById('search');
    search.addEventListener('input', ()=>{
      const q = search.value.toLowerCase();
      document.querySelectorAll('main section').forEach(sec=>{
        const hay = sec.innerText.toLowerCase().includes(q);
        sec.style.display = hay ? '' : 'none';
      });
    })
  </script>
</body>
</html>