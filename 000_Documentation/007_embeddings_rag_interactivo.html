
<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Incrustaciones Vectoriales en RAG ‚Äî Gu√≠a Interactiva</title>
<style>
:root{
  --bg:#0b0f14; --panel:#0f172a; --text:#e6edf3; --muted:#9fb0c0;
  --accent:#38bdf8; --accent2:#a78bfa; --border:#1f2937;
  --ok:#10b981; --warn:#f59e0b; --danger:#ef4444;
  --shadow:0 12px 32px rgba(0,0,0,.25);
}
[data-theme="light"]{
  --bg:#f7fafc; --panel:#ffffff; --text:#0b1220; --muted:#475569;
  --accent:#0284c7; --accent2:#7c3aed; --border:#e5e7eb;
  --ok:#059669; --warn:#b45309; --danger:#b91c1c;
  --shadow:0 10px 30px rgba(0,0,0,.08);
}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--text);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
.container{display:grid;grid-template-columns:300px 1fr;min-height:100vh}
aside{position:sticky;top:0;height:100vh;padding:22px 16px;border-right:1px solid var(--border);background:linear-gradient(180deg,var(--panel),rgba(0,0,0,0))}
.logo{font-weight:800;font-size:1.25rem;margin-bottom:6px}
.subtitle{color:var(--muted);font-size:.95rem;margin-bottom:16px}
nav a{display:block;padding:9px 10px;margin:6px 0;border-radius:12px;text-decoration:none;color:var(--text);border:1px solid transparent}
nav a:hover{border-color:var(--border);background:rgba(56,189,248,.10)}
.badge{display:inline-block;padding:4px 8px;border-radius:999px;font-size:.8rem;border:1px solid var(--border);color:var(--muted)}
.flex{display:flex;gap:8px;flex-wrap:wrap}
main{padding:36px 28px;max-width:1180px}
h1{margin:0 0 6px;font-size:2rem}
h2{margin-top:28px;font-size:1.35rem}
h3{margin-top:18px;font-size:1.05rem;color:var(--muted)}
.card{background:var(--panel);border:1px solid var(--border);border-radius:16px;box-shadow:var(--shadow);padding:18px;margin:18px 0}
.grid-2{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:14px}
table{width:100%;border-collapse:collapse;margin:10px 0;font-size:.95rem}
th,td{padding:10px 12px;border-bottom:1px solid var(--border);vertical-align:top}
th{text-align:left;color:var(--muted)}
.hint{background:linear-gradient(180deg,rgba(56,189,248,.10),rgba(56,189,248,.03));border:1px solid var(--border);border-radius:12px;padding:12px 14px;margin-top:10px}
.btns{position:fixed;right:16px;bottom:16px;display:flex;gap:10px;z-index:20}
.btn{background:var(--panel);color:var(--text);border:1px solid var(--border);border-radius:12px;padding:10px 12px;cursor:pointer;box-shadow:var(--shadow)}
.btn:hover{filter:brightness(1.05)}
.caption{color:var(--muted);font-size:.9rem;margin-top:6px}
svg{width:100%;height:auto;border-radius:12px;border:1px solid var(--border);background:linear-gradient(180deg,rgba(56,189,248,.08),rgba(56,189,248,.03))}
details{border:1px dashed var(--border);border-radius:12px;padding:10px 12px}
mark{background:rgba(56,189,248,.22);padding:1px 4px;border-radius:6px}
.footer{color:var(--muted);font-size:.9rem;margin-top:30px;border-top:1px dashed var(--border);padding-top:12px}
.code{background:#0b1220;border:1px solid var(--border);border-radius:12px;padding:12px;overflow:auto;font-family:ui-monospace,Menlo,Consolas,monospace;font-size:.9rem}
.small{font-size:.9rem;color:var(--muted)}
.legend{display:flex;gap:10px;flex-wrap:wrap;margin-top:8px}
.legend span{display:inline-flex;align-items:center;gap:6px;border:1px solid var(--border);padding:4px 8px;border-radius:999px;cursor:pointer}
.dot{width:10px;height:10px;border-radius:50%}
.dot.felino{background:#22c55e}
.dot.canino{background:#ef4444}
.dot.bovino{background:#eab308}
.dot.deporte{background:#3b82f6}
kbd{background:#0b1220;border:1px solid var(--border);border-radius:6px;padding:1px 5px}
</style>
</head>
<body data-theme="dark">
<div class="container">
  <aside>
    <div class="logo">Embeddings + RAG</div>
    <div class="subtitle">Espacio vectorial y playbook Azure</div>
    <nav>
      <a href="#resumen">1. Resumen</a>
      <a href="#espacio">2. Espacio vectorial (clusters)</a>
      <a href="#playbook">3. Playbook de almacenamiento</a>
      <a href="#similitud">4. Similitud y m√©tricas</a>
      <a href="#check">5. Checklist</a>
    </nav>
    <div class="hint">
      <strong>Tip:</strong> Usa <em>Imprimir</em> para exportar a PDF y üåó para alternar tema.
    </div>
    <div class="flex" style="margin-top:10px">
      <span class="badge">Embeddings</span>
      <span class="badge">Vector Search</span>
      <span class="badge">Coseno</span>
      <span class="badge">Azure AI</span>
    </div>
  </aside>

  <main>
    <header>
      <h1>Incrustaciones Vectoriales en RAG ‚Äî HTML Interactivo</h1>
      <p class="subtitle">Representa textos como vectores de alta dimensi√≥n para recuperar fragmentos relevantes y generar respuestas con contexto.</p>
    </header>

    <section id="resumen" class="card">
      <h2>1) Resumen</h2>
      <p>Las <strong>incrustaciones vectoriales</strong> convierten palabras/frases en vectores que capturan su <em>significado</em>. En RAG: ‚ë† conviertes consulta y documentos a vectores, ‚ë° recuperas los m√°s cercanos (top‚Äëk), ‚ë¢ el LLM genera la respuesta con esos fragmentos.</p>
    </section>

    <section id="espacio" class="card">
      <h2>2) Espacio vectorial (clusters sem√°nticos)</h2>
      <p class="small">Ilustraci√≥n 2D (los embeddings reales suelen tener 768‚Äì3072 dimensiones). Haz <kbd>clic</kbd> en la leyenda para ocultar/mostrar clusters.</p>
      <figure>
        <svg id="plot" viewBox="0 0 800 520" role="img" aria-label="Clusters sem√°nticos: felino, canino, bovino, deporte">
          <!-- Ejes -->
          <line x1="60" y1="460" x2="760" y2="460" stroke="var(--border)"/>
          <line x1="60" y1="60"  x2="60"  y2="460" stroke="var(--border)"/>
          <text x="730" y="480" class="small" fill="var(--muted)">dim 1</text>
          <text x="20"  y="80"  class="small" fill="var(--muted)" transform="rotate(-90 20,80)">dim 2</text>

          <!-- Puntos: felino (verde) -->
          <g data-cluster="felino" fill="#22c55e">
            <circle cx="180" cy="210" r="6"><title>felino: ‚Äúamigos felinos‚Äù</title></circle>
            <circle cx="210" cy="190" r="6"><title>felino: ‚Äúgato dom√©stico‚Äù</title></circle>
            <circle cx="195" cy="225" r="6"><title>felino: ‚Äúmaullar‚Äù</title></circle>
            <circle cx="230" cy="210" r="6"><title>felino: ‚Äúbigotes felinos‚Äù</title></circle>
          </g>

          <!-- Puntos: canino (rojo) -->
          <g data-cluster="canino" fill="#ef4444">
            <circle cx="360" cy="260" r="6"><title>canino: ‚Äúcompa√±ero canino‚Äù</title></circle>
            <circle cx="330" cy="240" r="6"><title>canino: ‚Äúperro pastor‚Äù</title></circle>
            <circle cx="350" cy="285" r="6"><title>canino: ‚Äúguau‚Äù</title></circle>
            <circle cx="385" cy="255" r="6"><title>canino: ‚Äúcollar para perros‚Äù</title></circle>
          </g>

          <!-- Puntos: bovino (amarillo) -->
          <g data-cluster="bovino" fill="#eab308">
            <circle cx="260" cy="340" r="6"><title>bovino: ‚Äúganado bovino‚Äù</title></circle>
            <circle cx="230" cy="330" r="6"><title>bovino: ‚Äúleche de vaca‚Äù</title></circle>
            <circle cx="285" cy="360" r="6"><title>bovino: ‚Äúmuu‚Äù</title></circle>
            <circle cx="300" cy="330" r="6"><title>bovino: ‚Äúestablo‚Äù</title></circle>
          </g>

          <!-- Punto lejano: deporte (azul) -->
          <g data-cluster="deporte" fill="#3b82f6">
            <circle cx="650" cy="120" r="7"><title>deporte: ‚Äúquarterback lanza un bal√≥n‚Äù</title></circle>
          </g>
        </svg>
        <div class="legend">
          <span data-toggle="felino"><i class="dot felino"></i> Felino</span>
          <span data-toggle="canino"><i class="dot canino"></i> Canino</span>
          <span data-toggle="bovino"><i class="dot bovino"></i> Bovino</span>
          <span data-toggle="deporte"><i class="dot deporte"></i> Deporte</span>
        </div>
        <figcaption class="caption">Elementos sem√°nticamente similares se agrupan; temas distintos (p.ej., deporte) quedan lejos.</figcaption>
      </figure>
    </section>

    <section id="playbook" class="card">
      <h2>3) Playbook de almacenamiento vectorial en Azure</h2>
      <div class="grid-2">
        <div>
          <h3>Decisiones r√°pidas</h3>
          <table>
            <thead><tr><th>Si necesitas‚Ä¶</th><th>Elige‚Ä¶</th><th>Por qu√©</th></tr></thead>
            <tbody>
              <tr><td>Chat sobre PDFs/DOCX + b√∫squeda por texto</td><td><strong>Azure AI Search</strong></td><td>Indexa no estructurado, soporte h√≠brido (BM25 + vectorial).</td></tr>
              <tr><td>Co-locar <em>documento + vector</em> en app operacional</td><td><strong>Cosmos DB</strong></td><td>NoSQL multi-regi√≥n, baja latencia; menos ETL.</td></tr>
              <tr><td>Personalizaci√≥n por sesi√≥n / cache vectorial</td><td><strong>Azure Cache for Redis</strong></td><td>Latencia ultra-baja; conjuntos peque√±os/calientes.</td></tr>
              <tr><td>Filtros complejos por metadatos</td><td><strong>AI Search</strong></td><td>Facetas, filtros, scoring perfilado.</td></tr>
              <tr><td>Escrituras frecuentes + replicaci√≥n global</td><td><strong>Cosmos DB</strong></td><td>RPO/RTO, <em>throughput</em> el√°stico.</td></tr>
            </tbody>
          </table>
        </div>
        <div>
          <h3>Diagrama de flujo</h3>
          <svg viewBox="0 0 660 360" role="img" aria-label="Flujo de decisi√≥n para almacenamiento vectorial">
            <defs><marker id="arrow" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto"><polygon points="0 0, 6 3, 0 6" fill="currentColor"/></marker></defs>
            <rect x="20" y="20" width="620" height="320" rx="12" ry="12" fill="rgba(2,132,199,.10)" stroke="var(--border)"/>
            <rect x="60" y="60" width="240" height="60" rx="10" fill="rgba(167,139,250,.25)" stroke="var(--border)"/>
            <text x="78" y="95">¬øNecesitas b√∫squeda h√≠brida y PDFs?</text>
            <text x="78" y="115" class="small">texto + vector + facetas</text>
            <rect x="360" y="60" width="240" height="60" rx="10" fill="rgba(34,197,94,.25)" stroke="var(--border)"/>
            <text x="380" y="95">¬øApp operacional multi‚Äëregi√≥n?</text>
            <text x="380" y="115" class="small">doc+vector juntos</text>
            <rect x="210" y="180" width="240" height="60" rx="10" fill="rgba(56,189,248,.25)" stroke="var(--border)"/>
            <text x="232" y="215">¬øCache / personalizaci√≥n por sesi√≥n?</text>
            <line x1="180" y1="120" x2="210" y2="180" stroke="currentColor" marker-end="url(#arrow)"/>
            <line x1="420" y1="120" x2="330" y2="180" stroke="currentColor" marker-end="url(#arrow)"/>
            <rect x="80" y="270" width="140" height="50" rx="10" fill="rgba(167,139,250,.25)" stroke="var(--border)"/><text x="105" y="300">AI Search</text>
            <rect x="260" y="270" width="140" height="50" rx="10" fill="rgba(34,197,94,.25)" stroke="var(--border)"/><text x="280" y="300">Cosmos DB</text>
            <rect x="440" y="270" width="140" height="50" rx="10" fill="rgba(56,189,248,.25)" stroke="var(--border)"/><text x="462" y="300">Redis Cache</text>
          </svg>
        </div>
      </div>
      <details style="margin-top:10px">
        <summary>Esquemas sugeridos</summary>
        <div class="grid-2">
          <pre class="code">{ // Azure AI Search (√≠ndice)
  "id": "string",
  "content": "string",
  "vector": "float[]",
  "metadata": { "title": "string", "source": "string", "created_at": "datetime", "tags": ["string"] }
}</pre>
          <pre class="code">{ // Cosmos DB (documento)
  "id": "string",
  "doc": { "...": "..." },
  "embed": [0.12, -0.03, ...], // vector
  "source": "ruta/p√°gina",
  "ts": "2025-05-10T12:00:00Z"
}</pre>
        </div>
      </details>
    </section>

    <section id="similitud" class="card">
      <h2>4) Similitud y m√©tricas</h2>
      <div class="grid-2">
        <div>
          <h3>M√©tricas de recuperaci√≥n</h3>
          <ul>
            <li><strong>Coseno</strong>: <code>cos(u,v)=u¬∑v / (||u||¬∑||v||)</code></li>
            <li><strong>Dot product</strong>: √∫til si los vectores est√°n normalizados.</li>
            <li><strong>Recall@k</strong> y <strong>Precision@k</strong> de los fragmentos recuperados.</li>
          </ul>
          <h3>Buenas pr√°cticas</h3>
          <ul>
            <li>Mismo modelo de embeddings para doc y consulta.</li>
            <li>Tuning de <strong>chunk</strong> (200‚Äì500 tokens) y <strong>k</strong> (3‚Äì8).</li>
            <li>Respuesta ‚Äú<em>no encontrado</em>‚Äù si no hay evidencia.</li>
          </ul>
        </div>
        <div>
          <h3>Pseudoc√≥digo RAG</h3>
          <pre class="code">q_vec = embed(query)
hits = search.hybrid(query, q_vec, k=5, filters=...)
ctx  = render(hits)  # texto + fuentes
answer = llm.complete(prompt(ctx, query))
return answer</pre>
          <h3>Prompt base</h3>
          <pre class="code">Sistema: Responde SOLO con el contexto. 
Si no hay evidencia suficiente, di "no encontrado".
Usuario: {pregunta}
Contexto:
1) {chunk_1} (fuente: {src_1})
2) {chunk_2} (fuente: {src_2})</pre>
        </div>
      </div>
    </section>

    <section id="check" class="card">
      <h2>5) Checklist</h2>
      <ul>
        <li>Ingesta con extracci√≥n de texto y metadatos.</li>
        <li>Chunking coherente + embeddings consistentes.</li>
        <li>√çndice/DB vectorial (AI Search, Cosmos o Redis) con filtros.</li>
        <li>Prompt aumentado + pol√≠tica de ‚Äúno encontrado‚Äù.</li>
        <li>Observabilidad: logs, m√©tricas y set dorado de pruebas.</li>
      </ul>
    </section>

    <div class="footer">
      Hecho para estudio personal. Personal√≠zalo para tus cursos o documentaci√≥n.
    </div>
  </main>
</div>

<div class="btns">
  <button class="btn" onclick="document.body.dataset.theme = (document.body.dataset.theme === 'light' ? 'dark' : 'light')">üåó Modo</button>
  <button class="btn" onclick="window.print()">üñ®Ô∏è Imprimir</button>
  <button class="btn" onclick="window.scrollTo({top:0, behavior:'smooth'})">‚¨ÜÔ∏è Arriba</button>
</div>

<script>
// Toggle clusters on legend click
const legendSpans = document.querySelectorAll('.legend span');
legendSpans.forEach(sp => {
  sp.addEventListener('click', () => {
    const key = sp.getAttribute('data-toggle');
    const group = document.querySelector('g[data-cluster="'+key+'"]');
    if(!group) return;
    const hidden = group.getAttribute('data-hidden') === 'true';
    group.style.opacity = hidden ? '1' : '0.12';
    group.setAttribute('data-hidden', hidden ? 'false' : 'true');
    sp.style.opacity = hidden ? '1' : '0.5';
  });
});
</script>
</body>
</html>
